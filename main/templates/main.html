{% extends 'base.html' %}

{% block meta %}
    <title>kpop-albums</title>
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body.no-scroll {
            overflow: hidden;
        }

        .main {
        background-color: #191719;
        position: absolute;
        display: flex;
        flex-direction: row;
        justify-content: center;
        width: 100%;
        height: 100vh;
        }

        .main .div {
        background-color: #191719;
        overflow: hidden;
        width: 1280px;
        height: 720px;
        position: absolute;
        }

        .main .contents-2 {
        position: absolute;
        width: 433px;
        height: 342px;
        top: 169px;
        left: 423px;
        }

        .main .div-wrapper {
        position: absolute;
        width: 435px;
        height: 32px;
        top: 158px;
        left: 0;
        }

        .main .text-wrapper {
        position: absolute;
        top: 0;
        left: 0;
        opacity: 0.8;
        font-family: 'Helvetica';
        font-weight: 400;
        color: #ffffff;
        font-size: 26.7px;
        text-align: center;
        letter-spacing: 0;
        line-height: normal;
        }

        .main .add-artists {
        position: absolute;
        width: 171px;
        height: 33px;
        top: 309px;
        left: 132px;
        }

        .main .overlap-group {
        width: 169px;
        height: 33px;
        border-radius: 17.98px;
        position: relative;
        background-color: #73a0c5;
        }

        .main .text-wrapper-2 {
        position: absolute;
        top: 8px;
        left: 29px;
        font-family: 'Helvetica';
        font-weight: 400;
        color: #ffffff;
        font-size: 13.3px;
        text-align: center;
        letter-spacing: 0;
        line-height: normal;
        }

        .main .header {
            position: fixed;
            width: 100%;
            height: 87px;
            top: 0;
            left: 0;
            background-color: #252124;
            box-shadow: 0px 2.67px 26.67px #00000040;
        }

        .main .r {
            position: relative;
            height: 30px;
            top: 29px;
            left: 82%; /* Initial position */
            transition: left 0.3s ease; /* Add smooth transition for the left property */
        }

        .main .header-image,
        .main .see-full-list,
        .main .add-artist {
            position: relative; /* Ensure child elements are positioned relative to .r */
        }

        .main .header-image {
        position: absolute;
        width: 30px;
        height: 30px;
        top: 0;
        left: 187px;
        }

        .main .see-full-list {
        position: absolute;
        width: 72px;
        height: 30px;
        top: 0;
        left: 103px;
        }

        .main .overlap-group-2 {
        position: relative;
        width: 70px;
        height: 30px;
        background-color: #aa8ec0;
        border-radius: 16.67px;
        }

        .main .text-wrapper-4 {
        position: absolute;
        top: 9px;
        left: 12px;
        font-family: 'Helvetica';
        font-weight: 800;
        color: #ffffff;
        font-size: 10px;
        text-align: center;
        letter-spacing: 0;
        line-height: normal;
        white-space: nowrap;
        }

        .main .add-artist {
        position: absolute;
        width: 93px;
        height: 30px;
        top: 0;
        left: 0;
        }

        .main .overlap {
        width: 91px;
        height: 30px;
        border-radius: 16.67px;
        position: relative;
        background-color: #73a0c5;
        }

        .main .text-wrapper-5 {
        position: absolute;
        top: 9px;
        left: 10px;
        font-family: 'Helvetica';
        font-weight: 800;
        color: #ffffff;
        font-size: 10px;
        text-align: center;
        letter-spacing: 0;
        line-height: normal;
        white-space: nowrap;
        }

        .main .text-wrapper-6 {
        position: absolute;
        top: 31px;
        left: 45px;
        font-family: 'Helvetica';
        font-weight: 900;
        color: #ffffff;
        font-size: 20px;
        text-align: center;
        letter-spacing: 0;
        line-height: normal;
        white-space: nowrap;
        }

        .main .contents-1 {
        position: absolute;
        width: 227px;
        height: 337px;
        top: 100px;
        left: 526px;
        }

        .main .artists {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 42.67px;
            position: absolute;
            top: 90%; /* Center the artists vertically */
            transform: translateY(-50%); /* Adjust for centering */
            left: 0;
            right: 0px; /* Center the artists horizontally */
            z-index: 0; /* Ensure the artists are behind the title */
        }

        .main .artist {
            position: relative;
            width: 152px;
            height: 230.67px;
        }

        .main .add-new-artist-main {
            position: relative;
            padding-top: 9px;
            font-family: 'Helvetica';
            font-weight: 800;
            color: #ffffff;
            font-size: 11px;
            text-align: center;
            letter-spacing: 0;
            line-height: normal;
            white-space: nowrap;
            z-index: 2; /* Add a higher z-index to bring it to the front */
            
        }

        .main .button-link {
            text-decoration: none;
        }


        .main .addart {
            position: absolute;
            width: 130px;
            height: 30px;
            background-color: #73A0C6;
            border-radius: 15px;
            top: 600px;
        }

        .main .buttons {
        position: absolute;
        width: 121px;
        height: 23px;
        top: 207px;
        left: 15px;
        }

        .main .buttons > div {
            margin-bottom: 30px; /* Adjust the margin value as needed */
        }

        .main .add-album {
        position: relative;
        height: 23px;
        background-color: #73A0C6;
        border-radius: 11.67px;
        margin-bottom: 10px;
        }

        .main .add-new-album {
        position: absolute;
        top: 5px;
        left: 10px;
        font-family: 'Helvetica';
        font-weight: 800;
        color: #ffffff;
        font-size: 11px;
        margin-left: 2.5px;
        text-align: center;
        letter-spacing: 0;
        line-height: normal;
        white-space: nowrap;
        }

        .main .delete-artist {
        position: relative;
        height: 23px;
        background-color: #9B4141;
        border-radius: 11.67px;
        margin-bottom: 10px;
        }

        .main .delete-artist1 {
        position: absolute;
        top: 5px;
        left: 17.5px;
        font-family: 'Helvetica';
        font-weight: 800;
        color: #ffffff;
        font-size: 11px;
        text-align: center;
        letter-spacing: 0;
        line-height: normal;
        white-space: nowrap;
        }

        .main .collapse {
        position: relative;
        height: 23px;
        background-color: #409b85;
        border-radius: 11.67px;
        }

        .main .vector {
        position: absolute;
        width: 19px;
        height: 6px;
        top: 9px;
        left: 51px;
        }

        .main .text-wrapper {
        position: absolute;
        width: 113px;
        top: 165px;
        left: 18px;
        font-family: 'Helvetica';
        font-weight: 800;
        color: #ffffff;
        font-size: 22.7px;
        text-align: center;
        letter-spacing: 0;
        line-height: normal;
        }

        .main .ellipse {
            position: absolute;
            width: 150px; /* Set the width to match the ellipse size */
            height: 150px; /* Set the height to match the ellipse size */
            top: 0;
            left: 0;
            background-color: #d9d9d9;
            border-radius: 50%; /* Use border-radius to create a perfect circle */
            overflow: hidden; /* Hide content outside the ellipse */
        }

        .main .ellipse img .artist-logo {
            width: 100%; /* Make sure the image fills the ellipse */
            height: 100%;
            object-fit: cover; /* Maintain aspect ratio and cover the entire space */
        }

        .main .title {
            position: absolute;
            width: 400px;
            height: 56px;
            top: 27.5%;
            left: 58%;
            transform: translateX(-50%);
            text-align: center;
        }

        .main .text-wrapper-3 {
            position: absolute;
            top: 0;
            left: 0;
            font-family: 'Helvetica';
            font-weight: 800;
            color: #ffffff;
            font-size: 46.7px;
            margin-right: 15px;
            text-align: center;
            letter-spacing: 0;
            line-height: normal;
        }

        .vector-icon {
        position: relative;
        width: 80.67px;
        height: 80.67px;
        }
        .dummy,
        .reset-directory {
        position: relative;
        font-weight: 800;
        }
        .reset-directory {
        font-size: var(--font-size-3xs);
        font-family: 'Helvetica';
        color: #ffffff;
        text-align: center;
        }
        .logout,
        .reset {
        cursor: pointer;
        border: 0;
        padding: 0;
        border-radius: 16.67px;
        width: 130px;
        height: 30px;
        justify-content: center;
        }
        .reset {
        background-color: #aa8fc0;
        display: flex;
        flex-direction: column;
        align-items: center;
        }
        .logout {
        background-color: #9b4141;
        }
        .logout,
        .popup,
        .vector-parent {
        display: flex;
        flex-direction: column;
        align-items: center;
        }
        .vector-parent {
        border-radius: 16.67px;
        background-color: #4f404b;
        width: 330px;
        height: 245px;
        justify-content: center;
        gap: 10px;
        }
        .popup {
        display: none;
        position: relative;
        width: 349px;
        height: 331px;
        overflow: hidden;
        justify-content: flex-end;
        box-sizing: border-box;
        max-width: 90%;
        max-height: 90%;
        margin-left: 1070px;
        top: 75px;
        text-align: center;
        font-size: var(--font-size-xl);
        color: #ffffff;
        font-family: 'Helvetica';
        }
        
        .main .delete-artist,
        .main .add-album {
            display: none;
        }
        
    </style>
{% endblock meta %}

{% block content %}
<div class="main">
    <div class="div">
    {% if artists %}
    <div class="contents-1">
        <div class="artists" id="artist-container">
            {% for artist in artists %}
            <div class="artist">
                <div class="buttons" data-artist-id="{{ artist.id }}">
                    <a href="{% if artist.name %}{% url 'main:add_album' artist_name=artist.name %}{% endif %}" class="button-link">
                        <div class="add-album" autofocus="{true}" id="add-album-{{ artist.id }}">
                            <div class="add-new-album">ADD NEW ALBUM</div>
                        </div>
                    </a>
                    <a href="{% url 'main:delete_artist' artist.name %}" class="delete-link">
                        <div class="delete-artist" id="delete-artist-{{ artist.id }}">
                            <div class="delete-artist1">DELETE ARTIST</div>
                        </div>
                    </a>
                    <div class="collapse" data-artist-id="{{ artist.id }}">
                        <img class="vector" src="./media/arrow down.png" />
                    </div>
                </div>
                <div class="text-wrapper">{{ artist.name }}</div>
                <div class="ellipse">
                    <a href="{% if artist.name %}{% url 'main:artist_detail' artist.name %}{% endif %}">
                        <img class="artist-logo" src="{{ artist.artist_logo_url }}" alt="{{ artist.name }}" style="max-width: 150px; max-height: 150px;">
                    </a>
                </div>
            </div>
            {% endfor %}

        </div>
        <div class="title"><div class="text-wrapper-3">{{ request.user.username }}'s Artists</div></div>
    </div>
    {% else %}
    <div class="contents-2">
        <div class="div-wrapper"><p class="text-wrapper">You have no artists in your directory...</p></div>
        <div class="title"><div class="text-wrapper-3">{{ request.user.username }}'s Artists</div></div>
    </div>
    {% endif %}
    </div>
    <div class="addart">
        <a href="{% url 'main:add_artist' %}" class="button-link">
            <div class="add-artist-main" autofocus="{true}" id="add-artist-mains">
                <div class="add-new-artist-main">ADD NEW ARTIST</div>
            </div>
        </a>
    </div>
    <nav class="header">
        <div class="r">
            <a href="#open-popup"><img class="header-image" id="header-image" src="media/header pp.png" /></a>
            <div class="see-full-list">
            <div class="overlap-group-2"><div class="text-wrapper-4">FULL LIST</div></div>
            </div>
            <div class="add-artist">
            <div class="overlap"><div class="text-wrapper-5">+ ADD ARTIST</div></div>
            </div>
        </div>
        <div class="text-wrapper-6">kpop-albums</div>
    </nav>    
</div>
<div id="open-popup" class="popup">
    <div class="vector-parent">
        <img class="vector-icon" alt="" src="media/pp big.png" />
        <div class="dummy">{{ request.user.username }}</div>
        <button class="reset" autofocus="{true}" id="reset">
            <div class="reset-directory" id="reset-button">RESET DIRECTORY</div>
        </button>
        <button class="logout" id="logout">
            <div class="reset-directory">LOGOUT</div>
        </button>
    </div>
</div>

<script>
    $(document).ready(function () {
        // Add an event listener to the header pp button
        $('#header-image').click(function () {
            // Toggle the visibility of the popup
            $('.popup').toggle();

            // Add or remove a class to body to prevent scrolling
            $('body').toggleClass('no-scroll');
        });

        // Add an event listener to the "RESET DIRECTORY" button in the popup
        $('#reset-button').click(function () {
            // Redirect to the reset_form URL
            window.location.href = "{% url 'main:reset_form' %}";
        });

        // Close the popup when clicking outside of it
        $(document).mouseup(function (e) {
            var popup = $('.popup');
            if (!popup.is(e.target) && popup.has(e.target).length === 0) {
                popup.hide();
                // Remove the no-scroll class when hiding the popup
                $('body').removeClass('no-scroll');
            }
        });

        // Add an event listener to the "LOGOUT" button in the popup
        $('#logout').click(function () {
            // Redirect to the logout URL
            window.location.href = "{% url 'main:logout' %}";
        });

        $('.collapse').click(function () {
            var artistId = $(this).data('artist-id');
            var buttons = $(this).closest('.buttons');
            
            // Toggle the visibility of "Add New Album" and "Delete Artist" buttons for the clicked artist
            var addAlbumButton = buttons.find('#add-album-' + artistId);
            var deleteArtistButton = buttons.find('#delete-artist-' + artistId);

            addAlbumButton.toggle();
            deleteArtistButton.toggle();

            // Rotate the "Vector" by 180 degrees if the "Add Album" button is visible
            var vector = $(this).find('.vector');
            vector.css('transform', addAlbumButton.is(':visible') ? 'rotate(180deg)' : 'rotate(0deg)');
        });
    });
</script>
{% endblock content %}